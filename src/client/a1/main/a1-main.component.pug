.main.lesson-container([class.fade]="lesson.inStage")
  .result(*ngFor="let result of progress.results; let i = index")
    .completed.stage(*ngFor="let points of result.points") {{ points }}
  .current
    .stage.on-hover(*ngFor="let stage of lesson.stages; let i = index", (click)="onStage(i)",
        [ngClass]="{completed: lesson.pointsFor(i), weenie: isStageWeenie(i)}")
      | {{ lesson.pointsFor(i) }}
    .next.stage.on-hover(*ngIf="lesson.isCompleted", (click)="onNext()",
        [ngClass]="{weenie: isNextWeenie()}", [@next]="") &rarr;
.power-panel.bottom-bar(*ngIf="!lesson.inStage && progress.allowedPowers.any",
    [@slideBottom]="")
  .power(*ngIf="progress.allowedPowers.autoPlay", (click)="powers.toggle('autoPlay')",
      [ngClass]="{ weenie: !powers.toggled.autoPlay }")
    play-icon([autoPlay]="powers.enabled.autoPlay")
.main.surface-container(*ngIf="lesson.inStage", [@fadeInOut]="")
  bouncing-ball([showBall$]="showBall$")
  .surface(*ngFor="let surface of lesson.surfaces", [@zoomInOut]="")
    .controls
      .goal.button((click)="onGoal()", [class.weenie]="isGoalWeenie()", [@goal]="stage.scene")
        img(src="/assets/listen-music-128.png", alt="Listen!")
      minus-fx([show$]="stage.goalMinusFx$")
      .spacer
      .play([class.active]="stage.isCount && transport.active()",
          [@play]="stage.scene", [@notes]="!stage.isGoal && player.noteCount")
        play-icon.button((click)="isGoalWeenie() || onPlayback()",
            [playNotes]="player.noteCount", [goalNotes]="stage.goalNotes",
            [autoPlay]="powers.enabled.autoPlay",
            [ngClass]="{disabled: isGoalWeenie(), weenie: isPlaybackWeenie()}")
        .counter(*ngIf="stage.isCount", (click)="onStandby()") {{ transport.count() || 1}}
      minus-fx([show$]="stage.playMinusFx$")
    html-grid(*ngIf="isGrid(surface)", [grid]="surface", [class.weenie]="isGridWeenie()")
    .controls
      .spacer
  .top-bar.back((click)="onStage()", *ngIf="lesson.inStage", [@slideTop]="") &larr;
.points(*ngIf="lesson.isCompleted && progress.points", [@slideTop]="") {{progress.points}}
stage-panel.bottom-bar(*ngIf="lesson.inStage", [@slideBottom]="")

